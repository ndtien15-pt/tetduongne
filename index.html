<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy New Year 2026</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
            font-family: 'Arial', sans-serif;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>

<canvas id="canvas"></canvas>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    let width, height;
    let fireworks = [];
    let particles = [];
    
    // Cấu hình đếm ngược
    let countdown = 5;
    let countdownTimer = null;
    let isNewYear = false;
    let textAlpha = 1; // Độ mờ của số đếm ngược

    function resize() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    // Màu sắc pháo hoa
    function randomColor() {
        const colors = ['#ff0043', '#14fc56', '#1e90ff', '#ffff00', '#ff00ff', '#00ffff', '#ffffff'];
        return colors[Math.floor(Math.random() * colors.length)];
    }

    // Lớp Pháo hoa (Bay lên)
    class Firework {
        constructor(x, y, targetX, targetY) {
            this.x = x;
            this.y = y;
            this.startX = x;
            this.startY = y;
            this.targetX = targetX;
            this.targetY = targetY;
            this.distanceToTarget = Math.sqrt(Math.pow(targetX - x, 2) + Math.pow(targetY - y, 2));
            this.distanceTraveled = 0;
            this.coordinates = [];
            this.coordinateCount = 3;
            while(this.coordinateCount--) {
                this.coordinates.push([this.x, this.y]);
            }
            this.angle = Math.atan2(targetY - y, targetX - x);
            this.speed = 2;
            this.acceleration = 1.05;
            this.brightness = Math.random() * 50 + 50;
            this.targetRadius = 1;
        }

        update(index) {
            this.coordinates.pop();
            this.coordinates.unshift([this.x, this.y]);

            if (this.targetRadius < 8) {
                this.targetRadius += 0.3;
            } else {
                this.targetRadius = 1;
            }

            this.speed *= this.acceleration;
            const vx = Math.cos(this.angle) * this.speed;
            const vy = Math.sin(this.angle) * this.speed;

            this.distanceTraveled = Math.sqrt(Math.pow(this.startX - this.x, 2) + Math.pow(this.startY - this.y, 2));

            if (this.distanceTraveled >= this.distanceToTarget) {
                createParticles(this.targetX, this.targetY);
                fireworks.splice(index, 1);
            } else {
                this.x += vx;
                this.y += vy;
            }
        }

        draw() {
            ctx.beginPath();
            ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y);
            ctx.strokeStyle = 'hsl(' + Math.random() * 360 + ', 100%, ' + this.brightness + '%)';
            ctx.stroke();
        }
    }

    // Lớp Hạt pháo hoa (Nổ ra)
    class Particle {
        constructor(x, y) {
            this.x = x;
            this.y = y;
            this.coordinates = [];
            this.coordinateCount = 5;
            while(this.coordinateCount--) {
                this.coordinates.push([this.x, this.y]);
            }
            this.angle = Math.random() * Math.PI * 2;
            this.speed = Math.random() * 10 + 1;
            this.friction = 0.95;
            this.gravity = 1;
            this.hue = Math.random() * 360;
            this.brightness = Math.random() * 50 + 50;
            this.alpha = 1;
            this.decay = Math.random() * 0.015 + 0.015;
        }

        update(index) {
            this.coordinates.pop();
            this.coordinates.unshift([this.x, this.y]);
            this.speed *= this.friction;
            this.x += Math.cos(this.angle) * this.speed;
            this.y += Math.sin(this.angle) * this.speed + this.gravity;
            this.alpha -= this.decay;

            if (this.alpha <= this.decay) {
                particles.splice(index, 1);
            }
        }

        draw() {
            ctx.beginPath();
            ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y);
            ctx.strokeStyle = 'hsla(' + this.hue + ', 100%, ' + this.brightness + '%, ' + this.alpha + ')';
            ctx.stroke();
        }
    }

    function createParticles(x, y) {
        let particleCount = 30;
        while(particleCount--) {
            particles.push(new Particle(x, y));
        }
    }

    // Vòng lặp chính
    function loop() {
        requestAnimationFrame(loop);
        
        // Hiệu ứng mờ đuôi
        ctx.globalCompositeOperation = 'destination-out';
        ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
        ctx.fillRect(0, 0, width, height);
        ctx.globalCompositeOperation = 'lighter';

        // 1. Xử lý Đếm ngược
        if (!isNewYear) {
            ctx.font = "bold 20vw Arial";
            ctx.fillStyle = `rgba(255, 255, 255, ${textAlpha})`;
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            
            if (countdown > 0) {
                ctx.fillText(countdown, width / 2, height / 2);
            }
            
            // Hiệu ứng mờ dần cho số
            if(textAlpha > 0) textAlpha -= 0.02; 
        }

        // 2. Xử lý Pháo hoa & Chữ Chúc mừng
        if (isNewYear) {
            // Chữ Chúc mừng
            ctx.font = "bold 8vw Arial";
            
            // Tạo hiệu ứng chữ đổi màu lấp lánh
            const gradient = ctx.createLinearGradient(0, 0, width, 0);
            gradient.addColorStop("0", "magenta");
            gradient.addColorStop("0.5", "blue");
            gradient.addColorStop("1.0", "red");
            
            ctx.fillStyle = gradient;
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText("HAPPY NEW YEAR", width / 2, height / 2 - 50);
            ctx.fillStyle = "#ffffff";
            ctx.fillText("2026", width / 2, height / 2 + 100);

            // Bắn pháo hoa ngẫu nhiên
            if (Math.random() < 0.1) { // Tốc độ bắn
                fireworks.push(new Firework(width / 2, height, Math.random() * width, Math.random() * height / 2));
            }
        }

        // Cập nhật pháo hoa
        let i = fireworks.length;
        while(i--) {
            fireworks[i].draw();
            fireworks[i].update(i);
        }

        // Cập nhật hạt nổ
        let j = particles.length;
        while(j--) {
            particles[j].draw();
            particles[j].update(j);
        }
    }

    // Logic đếm thời gian
    function startCountdown() {
        textAlpha = 1; // Reset độ rõ của chữ
        if (countdown > 0) {
            setTimeout(() => {
                countdown--;
                textAlpha = 1; // Mỗi lần đổi số thì làm rõ lại
                startCountdown();
            }, 1000);
        } else {
            isNewYear = true;
        }
    }

    // Bắt đầu
    loop();
    startCountdown();

</script>

</body>
</html>